<?xml version="1.0" encoding="UTF-8"?>
<!--
サービス提供可否判定ハンドラの設定
-->
<component-configuration
    xmlns="http://tis.co.jp/nablarch/component-configuration"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://tis.co.jp/nablarch/component-configuration  ../../component-configuration.xsd">

  <!-- サービス提供可否判定ハンドラ -->
  <component name="serviceAvailabilityCheckHandler"
      class="nablarch.common.handler.ServiceAvailabilityCheckHandler">
    <property name="serviceAvailability" ref="serviceAvailability" />
    <!-- 内部リクエストIDを使用してサービス提供可否判定を行う -->
    <property name="usesInternalRequestId" value="true" />
  </component>

  <!-- 開閉局機能を提供するフレームワーク基本実装 -->
  <component name="serviceAvailability"
             class="nablarch.common.availability.BasicServiceAvailability">
    <!-- 開閉局機能で使用するテーブル名／カラム名／サービス提供可能状態の文字列。 -->
    <property name="tableName" value="REQUEST" />
    <property name="requestTableRequestIdColumnName" value="ID" />
    <property name="requestTableServiceAvailableColumnName"
              value="STATE" />
    <property name="dbManager" ref="serviceAvailabilityDbManager" />
  </component>

  <!-- データベーストランザクション管理クラスの設定 -->
  <component name="serviceAvailabilityDbManager"
      class="nablarch.core.db.transaction.SimpleDbTransactionManager">
    <property name="dbTransactionName" value="serviceAvailability" />
    <!-- トランザクションファクトリ -->
    <property name="transactionFactory" ref="jdbcTransactionFactory" />
    <!-- コネクションファクトリ -->
    <property name="connectionFactory" ref="connectionFactory" />
  </component>
</component-configuration>